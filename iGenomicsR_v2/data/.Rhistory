365+75
combat_edata
library(sva)
library(limma)
library(ggplot2)
library(gplots)
library(reshape2)
options(stringsAsFactors = FALSE)
setwd("C:/projects/Endometrial Cancer/170110_compare_microarray/")
exp_table <- read.table("probe_exp_gene.SST-RMA-GENE-FULL - Group 3.TXT", sep = "\t", header=TRUE, row.names = 1)
gene_symbol <- exp_table[,49]
colnames(exp_table) <- sub(".combined.sst.rma.gene.full.Signal", "", colnames(exp_table))
exp_table <- exp_table[,1:48]
colnames(exp_table) <- sub("_2", "", colnames(exp_table))
group <- rep("old", ncol(exp_table))
group[grep("pico", colnames(exp_table))] <- "new"
pheno <- data.frame(batch=group)
pca.res <- prcomp(combat_edata)
shiny::runApp('C:/projects/iGenomicsR_BRCA')
runApp('C:/projects/iGenomicsR_BRCA')
runApp('C:/projects/iGenomicsR_BRCA')
options(stringsAsFactors = FALSE)
library("plyr")
setwd("C:/projects/iGenomicsR_BRCA/data/")
d1 <- read.csv("CPTAC_Image_epithelial.csv", header = TRUE, row.names = 1)
d2 <- read.csv("CPTAC_Image_stromal_40.csv", header = TRUE, row.names = 1)
head(d1)
all(colnames(d1) == colnames(d2))
d <- t(rbind(d1, d2))
sample_name <- colnames(d)
sample_name <- substring(sample_name, 3, 12)
sample_name <- gsub("\\.", "-", sample_name)
sample_name <- paste("TCGA-", sample_name, sep="")
sample_name
d <- rbind(d1, d2)
sample_name <- colnames(d)
sample_name <- substring(sample_name, 3, 12)
sample_name <- gsub("\\.", "-", sample_name)
sample_name <- paste("TCGA-", sample_name, sep="")
sample_name
DB[["Image"]] <- d
samples <- intersect(intersect(colnames(DB[["RNA"]]), colnames(DB[["Protein"]])), intersect(rownames(DB[["Clinical"]]), colnames(DB[["Mutation_gene"]])))
all(samples %in% colnames(DB[["Image"]]))
samples %in% colnames(DB[["Image"]])
DB[["Image"]] <-
# test mutation profile association
test_res <- list()
samples
head(colnames(DB[["Image"]]))
colnames(DB[["Image"]])
d1 <- read.csv("CPTAC_Image_epithelial.csv", header = TRUE, row.names = 1)
d2 <- read.csv("CPTAC_Image_stromal_40.csv", header = TRUE, row.names = 1)
all(colnames(d1) == colnames(d2))
d <- rbind(d1, d2)
sample_name <- colnames(d)
sample_name <- substring(sample_name, 3, 12)
sample_name <- gsub("\\.", "-", sample_name)
sample_name <- paste("TCGA-", sample_name, sep="")
colnames(d) <- sample_name
DB[["Image"]] <- d
all(samples %in% colnames(DB[["Image"]]))
DB[["Image"]] <- DB[["Image"]][,samples]
save(DB, file="../kun_20170212.RData")
runApp('C:/projects/iGenomicsR_BRCA')
runApp('C:/projects/iGenomicsR_BRCA')
runApp('C:/projects/iGenomicsR_BRCA')
runApp('C:/projects/iGenomicsR_BRCA')
runApp('C:/projects/iGenomicsR_BRCA')
heatmap.2(DB[["Image"]], trace="none", dendrogram = "none")
heatmap.2(DB[["Image"]][c("Nuclei_Area", "Fraction_Fiber", "Nuclei_Density"),], trace="none", dendrogram = "none")
heatmap.2(as.matrix(DB[["Image"]][c("Nuclei_Area", "Fraction_Fiber", "Nuclei_Density"),]), trace="none", dendrogram = "none")
heatmap.2(as.matrix(DB[["Image"]][c("Nuclei_Area", "Fraction_Fiber", "Nuclei_Density"),]), trace="none", dendrogram = "none", scale="row")
heatmap.2(as.matrix(DB[["Image"]][c("Nuclei_Area", "Fraction_Fiber", "Nuclei_Density"),]), trace="none", dendrogram = "none", scale="row", col = redgreen())
heatmap.2(as.matrix(DB[["Image"]][c("Nuclei_Area", "Fraction_Fiber", "Nuclei_Density"),]), trace="none", dendrogram = "none", scale="row", col = redgreen(20))
heatmap.2(as.matrix(DB[["Image"]][c("Nuclei_Area", "Fraction_Fiber", "Nuclei_Density"),]), trace="none", dendrogram = "none", scale="row", col = redgreen(20), breaks = seq(-2,2,0.1))
heatmap.2(as.matrix(DB[["Image"]][c("Nuclei_Area", "Fraction_Fiber", "Nuclei_Density"),]), trace="none", dendrogram = "none", scale="row", col = redgreen(20), breaks = seq(-2,2,0.2))
