summary(res.aov2)
for(mod in unique(CI$Model)){message(mod);message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)}
#**********************************************************************
# Maximum TMB correlation with C-Index
# Anova for cancer type and method
tmb.col = "Maximum.TMB"
CI = melt(ci.all);
CI$value2 = 0;
CI[CI[,"Var1"]=="BLCA","value2"] = TMB["bladder urothelial (transitional cell) carcinoma",tmb.col]
CI[CI[,"Var1"]=="BRCA","value2"] = TMB["breast carcinoma (nos)",tmb.col]
CI[CI[,"Var1"]=="CESC","value2"] = mean(TMB["cervix adenocarcinoma",tmb.col]+TMB["cervix squamous cell carcinoma (scc)",tmb.col])
CI[CI[,"Var1"]=="HNSC","value2"] = TMB["head and neck squamous cell carcinoma (hnscc)",tmb.col]
CI[CI[,"Var1"]=="KIRC","value2"] = TMB["kidney clear cell carcinoma",tmb.col]
CI[CI[,"Var1"]=="KIRP","value2"] = TMB["kidney renal papillary carcinoma",tmb.col]
CI[CI[,"Var1"]=="LIHC","value2"] = TMB["liver hepatocellular carcinoma (hcc)",tmb.col]
CI[CI[,"Var1"]=="LUAD","value2"] = TMB["lung adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="LUSC","value2"] = TMB["lung squamous cell carcinoma (scc)",tmb.col]
CI[CI[,"Var1"]=="OV","value2"] = TMB["ovary serous carcinoma",tmb.col]
CI[CI[,"Var1"]=="PAAD","value2"] = TMB["pancreas ductal adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="STAD","value2"] = TMB["stomach adenocarcinoma (nos)",tmb.col]
colnames(CI) = c("Cancer", "Model","value","value2")
for (i in 0:59){
if (i == 0){
CI.merge = cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4]))
}
else{
CI.merge = rbind(CI.merge,cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4])))
}
}
colnames(CI.merge) = c("Cancer", "Model","value","value2")
cor.test(log2(CI$value2+1),CI$value)
cor.test(log2(CI.merge$value2+1),CI.merge$value)
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
res.aov2 <- aov(value ~ Cancer + Model, data = CI)
summary(res.aov2)
for(mod in unique(CI$Model)){
message(mod)
message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)
}
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
res.aov2 <- aov(value ~ Cancer + Model, data = CI)
summary(res.aov2)
for(mod in unique(CI$Model)){
message(mod)
message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)
}
CI.merge
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line()+geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="blue", size=1.2)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="black", size=1.2)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="black", size=0.5)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="black", size=0.5)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="solid", color="black", size=0.1)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="black", size=0.1)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="black", size=0.1)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="grey", size=0.2)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="grey", size=0.3)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="solid", color="grey", size=0.3)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="grey", size=0.3)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
library(reshape2)
library(ggplot2)
setwd("/home/zhihuan/Documents/20180530_AECOX/TMB/TMB_AUC_cor/")
load("ci.all.Rdata")
TMB = read.csv("13073_2017_424_MOESM3_ESM.csv")
row.names(TMB) = TMB$Disease.type
#**********************************************************************
# Median TMB correlation with C-Index
# Anova for cancer type and method
tmb.col = "Median.TMB"
CI = melt(ci.all);
CI$value2 = 0;
CI[CI[,"Var1"]=="BLCA","value2"] = TMB["bladder urothelial (transitional cell) carcinoma",tmb.col]
CI[CI[,"Var1"]=="BRCA","value2"] = TMB["breast carcinoma (nos)",tmb.col]
CI[CI[,"Var1"]=="CESC","value2"] = mean(TMB["cervix adenocarcinoma",tmb.col]+TMB["cervix squamous cell carcinoma (scc)",tmb.col])
CI[CI[,"Var1"]=="HNSC","value2"] = TMB["head and neck squamous cell carcinoma (hnscc)",tmb.col]
CI[CI[,"Var1"]=="KIRC","value2"] = TMB["kidney clear cell carcinoma",tmb.col]
CI[CI[,"Var1"]=="KIRP","value2"] = TMB["kidney renal papillary carcinoma",tmb.col]
CI[CI[,"Var1"]=="LIHC","value2"] = TMB["liver hepatocellular carcinoma (hcc)",tmb.col]
CI[CI[,"Var1"]=="LUAD","value2"] = TMB["lung adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="LUSC","value2"] = TMB["lung squamous cell carcinoma (scc)",tmb.col]
CI[CI[,"Var1"]=="OV","value2"] = TMB["ovary serous carcinoma",tmb.col]
CI[CI[,"Var1"]=="PAAD","value2"] = TMB["pancreas ductal adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="STAD","value2"] = TMB["stomach adenocarcinoma (nos)",tmb.col]
colnames(CI) = c("Cancer", "Model","value","value2")
for (i in 0:59){
if (i == 0){
CI.merge = cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4]))
}
else{
CI.merge = rbind(CI.merge,cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4])))
}
}
colnames(CI.merge) = c("Cancer", "Model","value","value2")
png("../medianTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_point(size=1.5) +
labs(x="Median TMB (Log2)", y="Concordance Index") +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
cor.test(log2(CI$value2+1),CI$value)
cor.test(log2(CI.merge$value2+1),CI.merge$value)
res.aov2 <- aov(value ~ Cancer + Model, data = CI.merge)
summary(res.aov2)
for(mod in unique(CI$Model)){message(mod);message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)}
#**********************************************************************
# Percentage high TMB correlation with C-Index
# Anova for cancer type and method
tmb.col = "Percent.cases.with..20.mutations.Mb"
CI = melt(ci.all);
CI$value2 = 0;
CI[CI[,"Var1"]=="BLCA","value2"] = TMB["bladder urothelial (transitional cell) carcinoma",tmb.col]
CI[CI[,"Var1"]=="BRCA","value2"] = TMB["breast carcinoma (nos)",tmb.col]
CI[CI[,"Var1"]=="CESC","value2"] = mean(TMB["cervix adenocarcinoma",tmb.col]+TMB["cervix squamous cell carcinoma (scc)",tmb.col])
CI[CI[,"Var1"]=="HNSC","value2"] = TMB["head and neck squamous cell carcinoma (hnscc)",tmb.col]
CI[CI[,"Var1"]=="KIRC","value2"] = TMB["kidney clear cell carcinoma",tmb.col]
CI[CI[,"Var1"]=="KIRP","value2"] = TMB["kidney renal papillary carcinoma",tmb.col]
CI[CI[,"Var1"]=="LIHC","value2"] = TMB["liver hepatocellular carcinoma (hcc)",tmb.col]
CI[CI[,"Var1"]=="LUAD","value2"] = TMB["lung adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="LUSC","value2"] = TMB["lung squamous cell carcinoma (scc)",tmb.col]
CI[CI[,"Var1"]=="OV","value2"] = TMB["ovary serous carcinoma",tmb.col]
CI[CI[,"Var1"]=="PAAD","value2"] = TMB["pancreas ductal adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="STAD","value2"] = TMB["stomach adenocarcinoma (nos)",tmb.col]
colnames(CI) = c("Cancer", "Model","value","value2")
for (i in 0:59){
if (i == 0){
CI.merge = cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4]))
}
else{
CI.merge = rbind(CI.merge,cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4])))
}
}
colnames(CI.merge) = c("Cancer", "Model","value","value2")
png("../prc_highTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_point(size=1.5) +
labs(x="Hign TMB (Log2)", y="Concordance Index") +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
cor.test(log2(CI$value2+1),CI$value)
cor.test(log2(CI.merge$value2+1),CI.merge$value)
res.aov2 <- aov(value ~ Cancer + Model, data = CI)
summary(res.aov2)
for(mod in unique(CI$Model)){message(mod);message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)}
#**********************************************************************
# Maximum TMB correlation with C-Index
# Anova for cancer type and method
tmb.col = "Maximum.TMB"
CI = melt(ci.all);
CI$value2 = 0;
CI[CI[,"Var1"]=="BLCA","value2"] = TMB["bladder urothelial (transitional cell) carcinoma",tmb.col]
CI[CI[,"Var1"]=="BRCA","value2"] = TMB["breast carcinoma (nos)",tmb.col]
CI[CI[,"Var1"]=="CESC","value2"] = mean(TMB["cervix adenocarcinoma",tmb.col]+TMB["cervix squamous cell carcinoma (scc)",tmb.col])
CI[CI[,"Var1"]=="HNSC","value2"] = TMB["head and neck squamous cell carcinoma (hnscc)",tmb.col]
CI[CI[,"Var1"]=="KIRC","value2"] = TMB["kidney clear cell carcinoma",tmb.col]
CI[CI[,"Var1"]=="KIRP","value2"] = TMB["kidney renal papillary carcinoma",tmb.col]
CI[CI[,"Var1"]=="LIHC","value2"] = TMB["liver hepatocellular carcinoma (hcc)",tmb.col]
CI[CI[,"Var1"]=="LUAD","value2"] = TMB["lung adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="LUSC","value2"] = TMB["lung squamous cell carcinoma (scc)",tmb.col]
CI[CI[,"Var1"]=="OV","value2"] = TMB["ovary serous carcinoma",tmb.col]
CI[CI[,"Var1"]=="PAAD","value2"] = TMB["pancreas ductal adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="STAD","value2"] = TMB["stomach adenocarcinoma (nos)",tmb.col]
colnames(CI) = c("Cancer", "Model","value","value2")
for (i in 0:59){
if (i == 0){
CI.merge = cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4]))
}
else{
CI.merge = rbind(CI.merge,cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4])))
}
}
colnames(CI.merge) = c("Cancer", "Model","value","value2")
cor.test(log2(CI$value2+1),CI$value)
cor.test(log2(CI.merge$value2+1),CI.merge$value)
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="grey", size=0.3)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
res.aov2 <- aov(value ~ Cancer+ Model, data = CI)
summary(res.aov2)
for(mod in unique(CI$Model)){
message(mod)
message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)
}
Cancer*Model
res.aov2 <- aov(value ~ Cancer+ Model + Cancer*Model, data = CI)
res.aov2
summary(res.aov2)
library(reshape2)
library(ggplot2)
setwd("/home/zhihuan/Documents/20180530_AECOX/TMB/TMB_AUC_cor/")
load("ci.all.Rdata")
TMB = read.csv("13073_2017_424_MOESM3_ESM.csv")
row.names(TMB) = TMB$Disease.type
#**********************************************************************
# Median TMB correlation with C-Index
# Anova for cancer type and method
tmb.col = "Median.TMB"
CI = melt(ci.all);
CI$value2 = 0;
CI[CI[,"Var1"]=="BLCA","value2"] = TMB["bladder urothelial (transitional cell) carcinoma",tmb.col]
CI[CI[,"Var1"]=="BRCA","value2"] = TMB["breast carcinoma (nos)",tmb.col]
CI[CI[,"Var1"]=="CESC","value2"] = mean(TMB["cervix adenocarcinoma",tmb.col]+TMB["cervix squamous cell carcinoma (scc)",tmb.col])
CI[CI[,"Var1"]=="HNSC","value2"] = TMB["head and neck squamous cell carcinoma (hnscc)",tmb.col]
CI[CI[,"Var1"]=="KIRC","value2"] = TMB["kidney clear cell carcinoma",tmb.col]
CI[CI[,"Var1"]=="KIRP","value2"] = TMB["kidney renal papillary carcinoma",tmb.col]
CI[CI[,"Var1"]=="LIHC","value2"] = TMB["liver hepatocellular carcinoma (hcc)",tmb.col]
CI[CI[,"Var1"]=="LUAD","value2"] = TMB["lung adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="LUSC","value2"] = TMB["lung squamous cell carcinoma (scc)",tmb.col]
CI[CI[,"Var1"]=="OV","value2"] = TMB["ovary serous carcinoma",tmb.col]
CI[CI[,"Var1"]=="PAAD","value2"] = TMB["pancreas ductal adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="STAD","value2"] = TMB["stomach adenocarcinoma (nos)",tmb.col]
colnames(CI) = c("Cancer", "Model","value","value2")
for (i in 0:59){
if (i == 0){
CI.merge = cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4]))
}
else{
CI.merge = rbind(CI.merge,cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4])))
}
}
colnames(CI.merge) = c("Cancer", "Model","value","value2")
png("../medianTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_point(size=1.5) +
labs(x="Median TMB (Log2)", y="Concordance Index") +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
cor.test(log2(CI$value2+1),CI$value)
cor.test(log2(CI.merge$value2+1),CI.merge$value)
res.aov2 <- aov(value ~ Cancer + Model + Cancer*Model, data = CI)
summary(res.aov2)
for(mod in unique(CI$Model)){message(mod);message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)}
#**********************************************************************
# Percentage high TMB correlation with C-Index
# Anova for cancer type and method
tmb.col = "Percent.cases.with..20.mutations.Mb"
CI = melt(ci.all);
CI$value2 = 0;
CI[CI[,"Var1"]=="BLCA","value2"] = TMB["bladder urothelial (transitional cell) carcinoma",tmb.col]
CI[CI[,"Var1"]=="BRCA","value2"] = TMB["breast carcinoma (nos)",tmb.col]
CI[CI[,"Var1"]=="CESC","value2"] = mean(TMB["cervix adenocarcinoma",tmb.col]+TMB["cervix squamous cell carcinoma (scc)",tmb.col])
CI[CI[,"Var1"]=="HNSC","value2"] = TMB["head and neck squamous cell carcinoma (hnscc)",tmb.col]
CI[CI[,"Var1"]=="KIRC","value2"] = TMB["kidney clear cell carcinoma",tmb.col]
CI[CI[,"Var1"]=="KIRP","value2"] = TMB["kidney renal papillary carcinoma",tmb.col]
CI[CI[,"Var1"]=="LIHC","value2"] = TMB["liver hepatocellular carcinoma (hcc)",tmb.col]
CI[CI[,"Var1"]=="LUAD","value2"] = TMB["lung adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="LUSC","value2"] = TMB["lung squamous cell carcinoma (scc)",tmb.col]
CI[CI[,"Var1"]=="OV","value2"] = TMB["ovary serous carcinoma",tmb.col]
CI[CI[,"Var1"]=="PAAD","value2"] = TMB["pancreas ductal adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="STAD","value2"] = TMB["stomach adenocarcinoma (nos)",tmb.col]
colnames(CI) = c("Cancer", "Model","value","value2")
for (i in 0:59){
if (i == 0){
CI.merge = cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4]))
}
else{
CI.merge = rbind(CI.merge,cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4])))
}
}
colnames(CI.merge) = c("Cancer", "Model","value","value2")
png("../prc_highTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_point(size=1.5) +
labs(x="Hign TMB (Log2)", y="Concordance Index") +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
cor.test(log2(CI$value2+1),CI$value)
cor.test(log2(CI.merge$value2+1),CI.merge$value)
res.aov2 <- aov(value ~ Cancer + Model + Cancer*Model, data = CI)
summary(res.aov2)
for(mod in unique(CI$Model)){message(mod);message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)}
#**********************************************************************
# Maximum TMB correlation with C-Index
# Anova for cancer type and method
tmb.col = "Maximum.TMB"
CI = melt(ci.all);
CI$value2 = 0;
CI[CI[,"Var1"]=="BLCA","value2"] = TMB["bladder urothelial (transitional cell) carcinoma",tmb.col]
CI[CI[,"Var1"]=="BRCA","value2"] = TMB["breast carcinoma (nos)",tmb.col]
CI[CI[,"Var1"]=="CESC","value2"] = mean(TMB["cervix adenocarcinoma",tmb.col]+TMB["cervix squamous cell carcinoma (scc)",tmb.col])
CI[CI[,"Var1"]=="HNSC","value2"] = TMB["head and neck squamous cell carcinoma (hnscc)",tmb.col]
CI[CI[,"Var1"]=="KIRC","value2"] = TMB["kidney clear cell carcinoma",tmb.col]
CI[CI[,"Var1"]=="KIRP","value2"] = TMB["kidney renal papillary carcinoma",tmb.col]
CI[CI[,"Var1"]=="LIHC","value2"] = TMB["liver hepatocellular carcinoma (hcc)",tmb.col]
CI[CI[,"Var1"]=="LUAD","value2"] = TMB["lung adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="LUSC","value2"] = TMB["lung squamous cell carcinoma (scc)",tmb.col]
CI[CI[,"Var1"]=="OV","value2"] = TMB["ovary serous carcinoma",tmb.col]
CI[CI[,"Var1"]=="PAAD","value2"] = TMB["pancreas ductal adenocarcinoma",tmb.col]
CI[CI[,"Var1"]=="STAD","value2"] = TMB["stomach adenocarcinoma (nos)",tmb.col]
colnames(CI) = c("Cancer", "Model","value","value2")
for (i in 0:59){
if (i == 0){
CI.merge = cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4]))
}
else{
CI.merge = rbind(CI.merge,cbind(CI[i*5+1,1:2], mean(CI[(i*5+1):(i*5+5),3]), mean(CI[(i*5+1):(i*5+5),4])))
}
}
colnames(CI.merge) = c("Cancer", "Model","value","value2")
cor.test(log2(CI$value2+1),CI$value)
cor.test(log2(CI.merge$value2+1),CI.merge$value)
png("../maxTMB.png", width=1200, height=700, res = 250)
ggplot(CI.merge,aes(x=log2(value2+1),y=value,color=Cancer,shape=Model)) +
geom_line(linetype="dashed", color="grey", size=0.3)+
geom_point(size=1.5) +
labs(x="Maximum TMB (log2 transformed)", y="Concordance Index") +
theme_bw() +
theme(legend.title = element_text(size = 6),
legend.text = element_text(size = 5),
axis.title=element_text(size=8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.5, 'lines')
)
dev.off()
res.aov2 <- aov(value ~ Cancer + Model + Cancer*Model, data = CI)
summary(res.aov2)
for(mod in unique(CI$Model)){
message(mod)
message(cor.test(CI[CI$Model==mod,"value"],CI[CI$Model==mod,"value2"])$p.value)
}
View(res.aov2)
shiny::runApp('~/Desktop/iGenomicsR/iGenomicsR_v4')
setwd("~/Desktop/iGenomicsR/iGenomicsR_v4/")
runApp()
runApp()
runApp()
runApp()
